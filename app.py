import streamlit as st

# ページ設定
st.set_page_config(page_title="AIプロンプト製造機", page_icon="🚀", layout="wide")

# タイトル
st.title("🚀 AIプロンプト製造機")
st.write("キャラクターを選んでテーマを入力するだけで、玄人好みのプロンプトを一発生成します。")

# --- キャラクターデータの定義 ---
roles_data = {
    "■ 辛口・鬼系（刺さる）": [
        "鬼上司の投資顧問（結論先出し・容赦なし）",
        "辛辣な先輩トレーダー（体育会系）",
        "冷徹なファンドPM（数字以外信じない）",
        "失敗を許さないリスク管理責任者",
        "含み損に一切同情しない撤退番長",
        "「それ根拠ある？」しか言わない監査役",
        "楽観論を叩き潰す悲観シナリオ屋",
        "期待値警察（勝率とRRしか見ない）",
        "逆指値未設定にブチ切れる管理者",
        "ポジポジ病を矯正する鬼教官"
    ],
    "■ プロ・実務系（信頼ゾーン）": [
        "20年選手の日本株アナリスト",
        "元証券会社ディーラー",
        "機関投資家向け資料を作ってきた人",
        "決算短信を秒速で読む専門家",
        "グロース株専門の目利き",
        "バリュー株一点突破おじさん",
        "配当・優待ガチ勢",
        "中小型株スイング職人",
        "出来高・需給分析専門家",
        "テーマ株初動ハンター"
    ],
    "■ 戦略・思考整理系（初心者に神）": [
        "投資を図解で説明する先生",
        "思考を言語化してくれるコーチ",
        "エントリー条件だけを整理する人",
        "損切りだけを考える人",
        "「今やること」しか言わない秘書",
        "判断を3択に絞る整理屋",
        "シナリオ分岐専門家（上・横・下）",
        "感情とルールを切り分ける心理士",
        "ルール違反を検知する審判",
        "トレード日誌を添削する先生"
    ],
    "■ 市場・マクロ系": [
        "地合いだけを見る市場解説者",
        "日経平均・TOPIX番人",
        "米国市場翻訳マン",
        "金利・為替連動解説者",
        "セクター循環ウォッチャー",
        "政策・テーマ読み解き係",
        "決算シーズン警戒役",
        "暴落時専門アドバイザー",
        "バブル察知係",
        "大口の足跡追跡屋"
    ],
    "■ キャラ系（継続率アップ用）": [
        "優しいけど的確な投資コーチ",
        "毎回励ましてくれる伴走者",
        "逆神おじさん（反面教師）",
        "超慎重派の臆病アナリスト",
        "楽観的すぎる希望屋（※注意喚起付き）",
        "数字オタクの理系投資家",
        "感情ゼロのAI審判",
        "「今日は休め」と言う守護者",
        "利確だけ褒めてくれる人",
        "最後に現実を突きつける現場監督"
    ]
}

# --- 入力エリア（スッキリ化） ---
col1, col2 = st.columns(2)

with col1:
    # カテゴリ選択
    category = st.selectbox(
        "フヤセルAIの役割（カテゴリ選択）",
        list(roles_data.keys())
    )
    
with col2:
    # カテゴリに基づく詳細キャラ選択
    selected_role = st.selectbox(
        "具体的なキャラクター",
        roles_data[category]
    )

# 入力項目削減：ターゲット、トーン、出力形式は削除し、内部で固定
topic = st.text_area("やりたいこと・テーマ（必須）", height=150, placeholder="ここに分析したい銘柄や、相談したい内容を入力してください。")

# --- プロンプト生成ロジック ---
if st.button("プロンプトを生成する"):
    if topic:
        # 固定ターゲット層の設定
        target_audience = "株式投資に取り組む個人投資家（年齢層高め・経験豊富・実益重視）。表面的な情報よりも、具体的な根拠や示唆に富んだ内容、相場格言や経験則を好む。"

        # プロンプトのテンプレート
        prompt = f"""
# 命令書
あなたは「{selected_role}」になりきってください。
以下のターゲット読者層に向けた、最高品質の回答を出力してください。

## ターゲット読者
{target_audience}

## 入力文（やりたいこと）
{topic}

## 制約条件
- **文体**: キャラクターの性格を反映しつつ、投資家として納得感のあるプロの口調
- **内容**: 初心者向けの薄い内容ではなく、実践的で深みのある洞察を含めること
- **出力形式**: 読みやすいマークダウン形式（適宜、箇条書きや強調を使用）

## 出力
"""
        st.success("✨ 完成したプロンプト")
        st.code(prompt, language="markdown")
        
        st.info("右上のコピーボタンでコピーして、AIに貼り付けてください！")
    else:
        st.warning("「やりたいこと」を入力しないと、フヤにゃん困っちゃうにゃ…")
